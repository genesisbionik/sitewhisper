(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7996:function(e,t,a){Promise.resolve().then(a.bind(a,1943))},1943:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return z}});var r=a(7437),s=a(2265),n=a(2869),i=a(473),o=a(4508);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("textarea",{className:(0,o.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...s})});l.displayName="Textarea";var c=a(245);function d(e){let{onSend:t,disabled:a}=e,[i,o]=(0,s.useState)("");return(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),i.trim()&&(t(i),o(""))},className:"flex items-end gap-2 p-4 border-t",children:[(0,r.jsx)(l,{placeholder:"Ask about the analyzed content...",value:i,onChange:e=>o(e.target.value),className:"min-h-[80px] max-h-[200px]",disabled:a}),(0,r.jsx)(n.z,{type:"submit",size:"icon",disabled:a||!i.trim(),children:(0,r.jsx)(c.Z,{className:"h-4 w-4"})})]})}var m=a(8905),p=a(8453),u=a(8066),f=a(2023),g=a(7648);function h(){return(0,r.jsx)(n.z,{asChild:!0,className:"w-full",variant:"default",children:(0,r.jsxs)(g.default,{href:"/tokens",children:[(0,r.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Get More Tokens"]})})}var w=a(2735),x=a(7992);let b=a(257).env.NEXT_PUBLIC_DEEPSEEK_API_KEY;async function v(e,t){try{var a,r,s;let t=await fetch("https://api.deepseek.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(b)},body:JSON.stringify({model:"deepseek-reasoner",messages:e,temperature:.7,max_tokens:2e3,top_p:.95,frequency_penalty:0,presence_penalty:0})});if(!t.ok){let e=await t.text();throw Error("DeepSeek API Error: ".concat(t.status," ").concat(t.statusText,". ").concat(e))}let n=await t.json();if(console.log("API Response:",n),!(null===(s=n.choices)||void 0===s?void 0:null===(r=s[0])||void 0===r?void 0:null===(a=r.message)||void 0===a?void 0:a.content))throw Error("Invalid response structure from DeepSeek API");return n.choices[0].message.content}catch(e){throw console.error("DeepSeek API Error:",e),e}}console.log("OpenRouter initialization:",{isProduction:!0,hasApiKey:!!b,keyPrefix:null==b?void 0:b.substring(0,4)}),b||console.error("DeepSeek API key is missing. Please check your environment variables.");var y=a(29),k=a.n(y),j=a(2759);function S(e){let{isActive:t,message:a}=e;return(0,r.jsxs)("div",{className:(0,o.cn)("transition-opacity duration-300",t?"opacity-100":"opacity-0"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:"Crawling in progress..."}),(0,r.jsx)("span",{className:"text-sm text-muted-foreground animate-pulse",children:a||"Analyzing website content"})]}),(0,r.jsxs)("div",{className:"jsx-d12855bbd40f647 relative",children:[(0,r.jsx)(j.E,{value:100,className:"h-2 animate-progress"}),(0,r.jsx)(k(),{id:"d12855bbd40f647",children:"@-webkit-keyframes progress{0%{--tw-translate-x:-100%;-webkit-transform:translate(var(--tw-translate-x),0);transform:translate(var(--tw-translate-x),0)}100%{--tw-translate-x:100%;-webkit-transform:translate(var(--tw-translate-x),0);transform:translate(var(--tw-translate-x),0)}}@-moz-keyframes progress{0%{--tw-translate-x:-100%;-moz-transform:translate(var(--tw-translate-x),0);transform:translate(var(--tw-translate-x),0)}100%{--tw-translate-x:100%;-moz-transform:translate(var(--tw-translate-x),0);transform:translate(var(--tw-translate-x),0)}}@-o-keyframes progress{0%{--tw-translate-x:-100%;-o-transform:translate(var(--tw-translate-x),0);transform:translate(var(--tw-translate-x),0)}100%{--tw-translate-x:100%;-o-transform:translate(var(--tw-translate-x),0);transform:translate(var(--tw-translate-x),0)}}@keyframes progress{0%{--tw-translate-x:-100%;-webkit-transform:translate(var(--tw-translate-x),0);-moz-transform:translate(var(--tw-translate-x),0);-o-transform:translate(var(--tw-translate-x),0);transform:translate(var(--tw-translate-x),0)}100%{--tw-translate-x:100%;-webkit-transform:translate(var(--tw-translate-x),0);-moz-transform:translate(var(--tw-translate-x),0);-o-transform:translate(var(--tw-translate-x),0);transform:translate(var(--tw-translate-x),0)}}.animate-progress::-moz-progress-bar{-webkit-animation:progress 2s infinite linear;-moz-animation:progress 2s infinite linear;-o-animation:progress 2s infinite linear;animation:progress 2s infinite linear;background:-webkit-linear-gradient(left,transparent 0%,hsl(var(--primary))50%,transparent 100%);background:-moz-linear-gradient(left,transparent 0%,hsl(var(--primary))50%,transparent 100%);background:-o-linear-gradient(left,transparent 0%,hsl(var(--primary))50%,transparent 100%);background:linear-gradient(90deg,transparent 0%,hsl(var(--primary))50%,transparent 100%)}.animate-progress::-webkit-progress-value{-webkit-animation:progress 2s infinite linear;-moz-animation:progress 2s infinite linear;-o-animation:progress 2s infinite linear;animation:progress 2s infinite linear;background:-webkit-linear-gradient(left,transparent 0%,hsl(var(--primary))50%,transparent 100%);background:-moz-linear-gradient(left,transparent 0%,hsl(var(--primary))50%,transparent 100%);background:-o-linear-gradient(left,transparent 0%,hsl(var(--primary))50%,transparent 100%);background:linear-gradient(90deg,transparent 0%,hsl(var(--primary))50%,transparent 100%)}"})]})]})}let N={default:"You are SiteWhisper, an advanced AI website analyzer. Transform web content into structured, actionable intelligence. Use markdown formatting for better readability. Focus on providing clear, organized analysis with bullet points and sections.",siteWide:"You are SiteWhisper analyzing entire websites. Provide structured bullet-point lists. Focus on site-wide patterns and statistics. Use markdown formatting and clear headings.",pageSpecific:"You are SiteWhisper analyzing specific pages. Break down components, analyze structure, and highlight key information. Use markdown formatting with clear sections."};function z(){let[e,t]=(0,s.useState)([{role:"assistant",content:"\uD83D\uDC4B Welcome to SiteWhisper! Enter any website URL above to analyze and transform web content into AI-ready knowledge. I'll help you extract valuable information and create structured Whisper memory blocks that AI systems can understand.\n\nLet's begin! Just paste a URL to get started. âœ¨"}]),[a,o]=(0,s.useState)(!1),[l,c]=(0,s.useState)([]),[f,g]=(0,s.useState)(100),[b,y]=(0,s.useState)(!1),[k,j]=(0,s.useState)([]),{toast:z}=(0,x.pm)(),E=e=>{j(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},P=async e=>{if(console.log("Submitting URL:",e),f<10){z({title:"Not enough tokens",description:"Please purchase more tokens to continue scanning.",variant:"destructive"});return}try{let a;y(!0),o(!0),t(t=>[...t,{role:"user",content:"Analyzing ".concat(e)},{role:"assistant",content:"Starting the crawl process. This may take a few moments..."}]);let r=await fetch("https://urlsscrape-git-main-kartik1337s-projects.vercel.app/api/crawl?url=".concat(encodeURIComponent(e))),s=await r.json();if(!r.ok)throw Error("Failed to fetch URLs from local endpoint");let n=s.urls,i=await fetch("https://crawl4ai-production.up.railway.app/crawl",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({urls:n,priority:10,magic:!0,config:{session_id:"website_content_session",cache_mode:"bypass",extraction_strategy:{type:"llm",config:{task:"summarize",max_length:1e4,prompt:"Provide a concise summary of the main points and key information from this webpage. Focus on the most important details that describe what this page or site is about.",model:"gpt-3.5-turbo"}}}})}),l=await i.json();if(!i.ok)throw Error(l.error||"Failed to initiate crawl process");let{task_id:d}=l,m=20,p=8e3;for(;m>0;){try{a=await fetch("https://crawl4ai-production.up.railway.app/task/".concat(d));let r=await a.json();if(console.log("Task status:",r.status),a.ok&&"completed"===r.status){if(console.log("Task RESULT:",r),r.results&&r.results.length>0){r.results.map(e=>e.cleaned_html||e.html||"").join("\n\n");let a=[{id:"consolidated-block",title:e,content:(()=>{try{let e=JSON.parse(JSON.stringify(r));if(e.results&&e.results.length>0){let t=e.results.map(e=>{let t=e.html?e.html.replace(/<[^>]*>/g,"").replace(/\\n/g," ").replace(/\s+/g," ").trim():"";return{url:e.url,content:t}});return JSON.stringify(t)}return"No processable content"}catch(e){return console.error("Content parsing error:",e),"Content parsing failed"}})(),type:"whisper"}];c(a),t(t=>[...t,{role:"assistant",content:"I've analyzed ".concat(e," and created Whisper memory blocks. The crawl process is complete.")}]),g(e=>e-10);return}throw Error("Completed but no results found")}if("failed"===r.status)throw Error("Crawl task failed: ".concat(r.error||"Unknown error"));"processing"===r.status&&(console.log("Task in progress, attempts remaining: ".concat(m)),t(e=>[...e,{role:"assistant",content:"Still processing... (".concat(m," attempts remaining)")}]))}catch(e){console.error("Error polling task:",e)}m-=1,p*=1.5,await new Promise(e=>setTimeout(e,p))}if(0===m)throw Error("Task polling timed out - please try again")}catch(e){console.error("Error submitting URL:",e),z({title:"Submission Error",variant:"destructive"})}finally{o(!1),y(!1)}},_=async()=>{if(f<5){z({title:"Not enough tokens",description:"Please purchase more tokens to export data.",variant:"destructive"});return}if(l.length>0){let e=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="whisper_memory_blocks.json",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t),g(e=>e-5),z({title:"Export successful",description:"Your Whisper memory blocks have been exported successfully."})}},C=e=>(e=e.toLowerCase(),{isPageSpecific:["page","article","post","section","where","find","search","look for"].some(t=>e.includes(t)),isSiteWide:["how many","what is","website","site","overall","total","summary"].some(t=>e.includes(t))}),T=async a=>{if(f<2){z({title:"Not enough tokens",description:"Please purchase more tokens to continue chatting.",variant:"destructive"});return}t(e=>[...e,{role:"user",content:a}]),o(!0);try{let r=l[0];if(!r)throw Error("No memory block available");JSON.parse(r.content);let s=C(a);t(e=>[...e,{role:"assistant",content:"",isStreaming:!0}]);let n=e.length,i=s.isSiteWide?N.siteWide:s.isPageSpecific?N.pageSpecific:N.default,o="";await v([{role:"system",content:i},{role:"user",content:a}],e=>{o+=e,t(e=>{let t=[...e];return t[n]&&(t[n]={role:"assistant",content:o,isStreaming:!0}),t})}),t(e=>{let t=[...e];return t[n]&&(t[n]={role:"assistant",content:o,isStreaming:!1}),t}),g(e=>e-2)}catch(e){console.error("Error in chat:",e),t(e=>[...e,{role:"assistant",content:"I encountered an error while processing your request. Please try again.",isStreaming:!1}])}finally{o(!1)}},A=f>0;return(0,r.jsx)("div",{className:"container mx-auto flex min-h-[calc(100vh-4rem)] flex-col gap-4 p-4 max-w-7xl",children:(0,r.jsxs)("div",{className:"grid gap-4 lg:grid-cols-[2fr,1fr]",children:[(0,r.jsxs)("div",{className:"flex flex-col rounded-lg border bg-background shadow-sm",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4 border-b p-4",children:[(0,r.jsx)(p.$,{onSubmit:P,isLoading:b}),(0,r.jsx)(S,{isActive:b,message:b?"Analyzing website content...":void 0})]}),(0,r.jsx)("div",{className:"flex-1 overflow-auto",children:(0,r.jsxs)("div",{className:"divide-y",children:[e.map((e,t)=>(0,r.jsx)(i.J,{...e},t)),a&&(0,r.jsx)(i.J,{role:"assistant",content:"",isLoading:!0})]})}),(0,r.jsx)(d,{onSend:T,disabled:!A||a})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsx)(u.Y,{availableTokens:f,maxTokens:100}),(!A||f<5)&&(0,r.jsx)(h,{}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Whisper Memory"}),(0,r.jsxs)(n.z,{variant:"outline",size:"sm",onClick:_,disabled:0===l.length||!A,children:[(0,r.jsx)(w.Z,{className:"mr-2 h-4 w-4"}),"Export"]})]}),(0,r.jsx)("div",{className:"space-y-4",children:l.length>0?l.map((e,t)=>(0,r.jsx)(m.f,{url:e.title,content:e.content,isSelected:k.includes(e.id),onClick:()=>E(e.id)},e.id||"block-".concat(t))):(0,r.jsx)("div",{className:"rounded-lg border border-dashed p-8 text-center text-sm text-muted-foreground",children:"No Whisper memory blocks yet. Start by analyzing a website."})})]})]})})}}},function(e){e.O(0,[50,808,972,670,280,971,117,744],function(){return e(e.s=7996)}),_N_E=e.O()}]);